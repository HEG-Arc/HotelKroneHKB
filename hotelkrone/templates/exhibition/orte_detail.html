{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">

  <head>
    <meta property="og:url"           content="https://hotelkrone.be" />
    <meta property="og:type"          content="website" />
    <meta property="og:title"         content="Homepage of the BA Fine Arts Diploma 2020, HKB, Bern" />
    <meta property="og:description"   content="This page presents the works of the BA fine arts diploma students of the HKB Bern" />
    <meta property="og:description"   content="Diploma, HKB, hotelkrone, hotelkrone.be, fine arts, BA fine arts, Bachelor fine arts" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="keywords" content="diploma BA fine arts, HKB, Bern, Hochschule der Künste, Kunsthauslangenthal, Soraya Amini, Louna Berkane, Adriana Bravo, Rozenn Droz, Benjamin Gaschen, Zeno Germinale, Lukas Hirschhofer, Quentin Keller, Lea Luzifer, Kira Mäder, Matteo Petruzzi, Sina Schöpf, Anouk Ursin, Lisa Zuber">
    <meta name="description" content="Homepage of the BA Fine Arts Diploma 2020, HKB, Bern">
    <meta name="date" content="June 2020">

  {% if object.entrance %}
    <title>Hotel Krone: Homepage</title>
  {% else %}
    <title>Hotel Krone: {{ object.name }}</title>
  {% endif %}
  {% if object.animation == 'INFI' %}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
    <style>
        #map {
          width: 100%;
          height: 100%;
          position: absolute;
          right: 0;
          top: 0;
        }
    </style>
  {% elif object.animation == 'EQUI' %}
    <script src="{% static 'js/three.min.js' %}"></script>
    <script src="{% static 'js/panolens.min.js' %}"></script>
  {% endif %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Source+Sans+Pro:wght@300;400;600;700&family=Zilla+Slab:wght@500&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.hotelkrone.be/css/master-hk.css">
    <link rel="stylesheet" href="{% static 'css/project.css' %}">

    <link rel="icon" type="image/jpg" href="{% static 'media/webicon.jpg' %}">
  </head>
  
  
  <body>

      <div id="main">
        <div id="topline">
          <div id="corner-top-left">
            <img src="{% static 'media/corner-tl.png' %}" width="100%" height="100%" alt="">
          </div>
          <div id="top-hotel">		
            <div id="title-hotel">
              <a href="{% url 'home' %}" class="linknames title">Hotel Krone</a>
                {%  if not object.entrance %}
                <span class="subtitle">: {{ object.name }}</span>
              {% endif %}
            </div>
          </div>
          <div id="corner-top-right">
            <img src="{% static 'media/corner-tr.png' %}" width="100%" height="100%" alt="">
          </div>
        </div>

        <div id="middle">
			    <div id="mar-left">
            {%  if object.entrance %}
              <div id="txtleft"><span class="whitetxt">x</span></div>
            {% else %}
              <div id="txtleft"><a href="{{ object.previous.get_absolute_url }}" class="linknames">{{ object.previous.name }}</a></div>
            {% endif %}
          </div>

          <div id="key" >
            <div id="keycontent">
              <div id="keycase">
                  {% for ort in orte_list %}
                    <a href="{{ ort.get_absolute_url }}" class="linkrooms rooms">{{ ort.name }}</a>
                  {% endfor %}
                </div>
                <div id="room">
                {% if object.animation == 'NOJS' %}
                     <div id="container" style="position:relative; height:100%">
                         {% if object.background %}
                             <img id="backgroundIMG" src="{{ object.background.url }}" width="100%" alt="">
                         {% else %}
                             {{ object.html_embed|safe }}
                         {% endif %}
                     </div>
                {% elif object.animation == 'INFI' %}
                    {% if object.background %}

                        <div id="map"></div>
                        <script type="text/javascript">

                            var clientHeight = document.getElementById('map').clientHeight;
                            var clientWidth = ( {{object.map_width}} /  {{ object.map_height}} ) * clientHeight ;
                          var bounds = [[0,0], [clientHeight,clientWidth]];
                          var map = L.map('map', {
                            crs: L.CRS.Simple,
                            maxBounds: bounds,
                            maxBoundsViscosity: 1.0,
                            zoomControl: false

                          });

                          var image = L.imageOverlay('{{ object.background.url }}', bounds).addTo(map);

                          map.fitBounds(bounds);


                          {% if   object.position_x and  object.position_y%}
                             {% if  object.zoom != 1 %}
                                map.setView([{{object.position_x}}, {{object.position_y}}],{{object.zoom}});
                             {% else %}
                                 map.setView([{{object.position_x}}, {{object.position_y}}]);
                            {% endif  %}

                          {% endif  %}


                        </script>


                    {% endif %}
                {% elif object.animation == 'EQUI' %}
                {% endif %}
                </div>
              </div>
            </div>

            <div id="mar-right">
              {%  if object.entrance %}
                <div id="txtright"><span class="whitetxt">x</span></div>
              {% else %}
                <div id="txtright"><a href="{{ object.next.get_absolute_url }}" class="linknames">{{ object.next.name }}</a></div>
              {% endif %}
            </div>
        </div>

        <div id="bottom">
          <div id="corner-down-left">
            <img src="{% static 'media/corner-bl.png' %}" width="100%" height="100%" alt="">
          </div>

          <div id="corner-down-right">
            <img src="{% static 'media/corner-br.png' %}" width="100%" height="100%" alt="">
          </div>

          <div id="ground">
            {% if object.entrance %}
            <div id="groundnames" class="namesnew">
                <ul class="namelist">
                {% for student in students %}
                  <li><a class="linknames spacenamein" href="{{ student.get_absolute_url }}">{{ student.first_name }} {{ student.last_name }}</a>&nbsp;</li>
                {% endfor %}
                </ul>
            </div>
            <div id="groundtext">
              {{ object.description|safe }}
            </div>
            {% else %}
            <div id="groundtext-ort">
              {{ object.description|safe }}
            </div>
            {% endif %}

            {% include "exhibition/snippet_footer.html" %}
          </div>
        </div>
      </div>


    {% include "exhibition/snippet_impressum.html" %}
    <!-- Fin Calque media & impressum -->
    {% if contents.display_program and object.entrance %}
        {% include "exhibition/snippet_program.html" %}
    {% endif %}

      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
	  <script>
          function toggleOverlay(mediaId) {
              let x = document.getElementById(mediaId);
              if (x.style.display === "none") {
                x.style.display = "block";
                document.body.classList.add("noscroll");
              } else {
                x.style.display = "none";
                document.body.classList.remove("noscroll");
              }
          }
      </script>
	{%  if object.background_sound %}
      <audio id="background-audio">
        <source src="{{ object.background_sound.url }}" type="audio/mpeg">
      </audio>
      <script>
      var button = document.getElementById("play-button");
      var audio = document.getElementById("background-audio");

      button.addEventListener("click", function(){
        if(audio.paused){
          audio.play();
        } else {
          audio.pause();
        }
      });
      </script>
      {% endif %}

      {% for poi in object.poi_set.all %}
              <div class="overlayframe" id="media{{ poi.pk }}" style="display:none;">
                <div class="overlay">
                  <a href="#" class="linkoverlay" onclick="toggleOverlay('media{{ poi.pk }}'); return false"><img class="overlay-close" src="{% static 'media/close-white.png' %}"></a>
                  <a href="{{poi.media.student.get_absolute_url}}" class="overlay-student linkoverlay">{{poi.media.student.first_name}} {{poi.media.student.last_name}}</a>
                  <span class="overlay-title">{{poi.media.name}}</span>
                  <div class="overlay-content">

                    <div class="overlay-element w-75 {% if poi.this_specific_class_endless %} endless_map_overlay {% endif %}" >


                        {% if poi.media.image %}
                        <img src="{{ poi.media.image.url }}" class="overlay-image" />
                        {% else %}
                            {{ poi.media.html_embed|safe }}
                        {% endif %}

                    </div>
                    <p class="overlay-caption">{{poi.media.legend}}</p>
                    <div class="overlay-description">
                      {{poi.media.description|safe}}
                    </div>
                  </div>
                </div>
              </div>

      {% endfor %}


      {% if object.animation == 'NOJS' %}



          <script>
            <!-- Si on n est pas à la home page on mets a 0 le menu des places  -->
           {% if not object.entrance %}
               var menuOrte = document.getElementById('keycase');
               menuOrte.style.width = "0%";
               menuOrte.style.padding ="0px"

           {% endif %}

            var block = document.getElementById('room');
            var height = block.clientHeight;
            var width = block.clientWidth;

            $(function() {
            $("#room").click(function(e) {
              var offset = $(this).offset();
              var relativeX = (e.pageX - offset.left);
              var relativeY = (e.pageY - offset.top);
              console.log("x " + (relativeX*100) / width +' : y '+(relativeY*100) / height);
              $(".position").val("afaf");
            });
            });


            document.getElementById("backgroundIMG").style.position="relative"


             {% for poi in object.poi_set.all %}
                    var img{{ poi.id }} = document.createElement("img");
                    img{{ poi.id }}.src = "{{poi.poi_image.url}}";


                    block.appendChild(img{{ poi.id }});

                    img{{ poi.id }}.style.position = "absolute";
                    img{{ poi.id }}.style.top = "{{poi.position_y}}%" ;
                    img{{ poi.id }}.style.left = "{{poi.position_x}}%";
                    img{{ poi.id }}.style.maxWidth = "{{poi.position_w}}%"; //22%
                    img{{ poi.id }}.style.maxHeight = "{{poi.position_h}}%"; //47%
                    img{{ poi.id }}.classList.add( "img-fluid");
                    {% if poi.css_class %}
                        img{{ poi.id }}.classList.add("{{ poi.css_class }}");
                    {% endif %}

                 {% if poi.this_is_a_sound %}
                    var sound{{ poi.id }}      = document.createElement('audio');
                    sound{{ poi.id }}.id       = 'audio-player';
                    sound{{ poi.id }}.src      = '{{ poi.media.sound.url }}';
                    sound{{ poi.id }}.type     = 'audio/mpeg';
                    block.appendChild(sound{{ poi.id }});
                    img{{ poi.id }}.onclick = function(){
                        if(sound{{ poi.id }}.paused){
                          sound{{ poi.id }}.play();
                        } else {
                          sound{{ poi.id }}.pause();
                        }
                    };
                 {% elif poi.url_link %}
                     img{{ poi.id }}.onclick = function(){
                            window.location.href = "{{ poi.url_link }}";
                    };

                 {% else %}
                     img{{ poi.id }}.onclick = function(){
                        toggleOverlay('media{{ poi.pk }}');
                     };
                 {% endif %}
             {% endfor %}

          </script>

      {% elif object.animation == 'INFI' %}
          <script>
            {% for poi in object.poi_set.all %}
                var greenIcon{{ poi.id }} = L.icon({
                    iconUrl: '{{poi.poi_image.url}}',

                    iconSize:     [{{poi.position_w}}, {{poi.position_h}}], // size of the icon
                    iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
                    popupAnchor:  [-3, -76], // point from which the popup should open relative to the iconAnchor
                    {% if poi.css_class %}
                        className:  '{{ poi.css_class }}',
                    {% endif %}
                });


                {% if poi.this_is_a_sound %}

                    var block = document.getElementById('room');

                    var sound{{ poi.id }}      = document.createElement('audio');
                    sound{{ poi.id }}.id       = 'audio-player';
                    sound{{ poi.id }}.src      = '{{ poi.media.sound.url }}';
                    sound{{ poi.id }}.type     = 'audio/mpeg';
                    {% if poi.orte.name == "Spa" %}
                        sound{{ poi.id }}.loop = true;
                    {% endif %}
                    block.appendChild(sound{{ poi.id }});

                    L.marker([{{poi.position_x}}, {{poi.position_y}}], {icon: greenIcon{{ poi.id }}}).addTo(map).on('click', function(e) {
                       if(sound{{ poi.id }}.paused){
                              sound{{ poi.id }}.play();
                            } else {
                              sound{{ poi.id }}.pause();
                            }
                        });
                {% elif poi.url_link %}
                    L.marker([{{poi.position_x}}, {{poi.position_y}}], {icon: greenIcon{{ poi.id }}}).addTo(map).on('click', function(e) {
                        window.location.href = "{{ poi.url_link }}";
                    });


                {%else %}

                    L.marker([{{poi.position_x}}, {{poi.position_y}}], {icon: greenIcon{{ poi.id }}}).addTo(map).on('click', function(e) {
                        console.log(e.latlng);
                        toggleOverlay('media{{ poi.pk }}');
                    });
                {% endif %}

            {% endfor %}
           map.on('click', function(e){
                  var coord = e.latlng;
                  var lat = coord.lat;
                  var lng = coord.lng;
                  console.log("You clicked the map at latitude: " + lat + " and longitude: " + lng);
                });

          </script>

      {% elif object.animation == 'EQUI' %}


          <script>
              {% if object.background %}
                  const panorama = new PANOLENS.ImagePanorama( '{{ object.background.url }}'   );
                  var content = document.getElementById('main');
              {% endif %}



              {% for poi in object.poi_set.all %}


                  infospot{{ poi.pk }} = new PANOLENS.Infospot( {{ poi.scale }}, '{{ poi.poi_image.url }}', false );
                  infospot{{ poi.pk }}.position.set( {{ poi.position_x }}, {{ poi.position_y }}, {{ poi.position_z }} );
                  {% if not poi.hide_overlay and not poi.this_is_a_sound and not poi.url_link%}
                          infospot{{ poi.pk }}.addHoverText( "{{ poi.name }} ", 50 );
                          infospot{{ poi.pk }}.addEventListener( 'click', function(){
                              toggleOverlay('media{{ poi.pk }}');
                          } );
                  {% endif %}

                  {% if poi.this_is_a_sound %}

                    var sound{{ poi.pk }}      = document.createElement('audio');
                    sound{{ poi.pk }}.id       = 'audio-player{{ poi.pk }}';
                    sound{{ poi.pk }}.src      = '{{ poi.media.sound.url }}';
                    sound{{ poi.pk }}.type     = 'audio/mpeg';
                    content.appendChild(sound{{ poi.pk }});

                    infospot{{ poi.pk }}.addEventListener( 'click', function(){

                        if(sound{{ poi.pk }}.paused){

                          sound{{ poi.pk }}.play();

                        } else {

                          sound{{ poi.pk }}.pause();

                        }
                      } );
                  {% elif poi.url_link %}
                      infospot{{ poi.pk }}.addEventListener( 'click', function(){

                        window.location.href = "{{ poi.url_link }}";
                      } );

                  {% endif %}
                  {% if poi.css_class %}

                  {% endif %}
                  panorama.add( infospot{{ poi.pk }} );
              {% endfor %}
                var lookAtPositions = new THREE.Vector3({{ object.position_x }}, {{ object.position_y }},{{ object.position_z }});

                panorama.addEventListener( 'enter-fade-start', function(){
                    viewer.tweenControlCenter( lookAtPositions, 0 );
                } );

              const viewer = new PANOLENS.Viewer({
                  container: document.getElementById("room"),
                  controlBar: false,
                  output: 'console',
                  autoHideInfospot: false

              });
              viewer.add( panorama );

          </script>

      {% endif %}
      <!-- Preload navigation right and left -->
      <div style="display: none;">
          {% if object.next.background %}
            <img src="{{ object.next.background.url }}" />
          {% endif %}
          {% if object.previous.background %}
            <img src="{{ object.previous.background.url }}" />
          {% endif %}
      </div>

  </body>
</html>
